<script>
import { Doughnut } from 'vue-chartjs';

export default {
    props: {
        countDistribution: Object
    },
    components: {
        Doughnut,
    },
    computed: {
        targetDistChartData() {
            return {
                options: {
                    cutout: 60,
                    elements: {
                        arc: {
                            borderWidth: 0,
                        },
                    },
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'point',
                        },
                        title: {
                            display: true,
                            text: 'Vulnerabilities Severity Distribution',
                        },
                        legend: {
                            display: true,
                            labels: {
                                boxWidth: 12,
                            },
                        },
                    },
                },
                data: {
                    labels: [['High'], ['Medium'], ['Low']],
                    datasets: [
                        {
                            hoverBackgroundColor: ['#ef5350', '#ff9800', '#4caf50'],
                            backgroundColor: ['#ef5350', '#ff9800', '#4caf50'],
                            data: [
                                this.countDistribution.high,
                                this.countDistribution.medium,
                                this.countDistribution.low,
                            ],
                        },
                    ],
                }
            };
        },
        severityDistChartData() {
            return {
                options: {
                    cutout: 60,
                    elements: {
                        arc: {
                            borderWidth: 0,
                        },
                    },
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'point',
                        },
                        title: {
                            display: true,
                            text: 'Vulnerabilities Target Distribution',
                        },
                        legend: {
                            display: true,
                            labels: {
                                boxWidth: 12,
                            },
                        },
                    },
                },
                data: {
                    labels: [['Platform'], ['Image'], ['Node'], ['Container']],
                    datasets: [
                        {
                            hoverBackgroundColor: ['#f22d3a', '#86aec2', '#4D5360', '#36A2EB'],
                            backgroundColor: ['#f22d3a', '#86aec2', '#4D5360', '#36A2EB'],
                            data: [
                                this.countDistribution.platform,
                                this.countDistribution.image,
                                this.countDistribution.node,
                                this.countDistribution.container,
                            ],
                        },
                    ],
                }
            };
        }
    },
}
</script>

<template>
    <div style="height: 400px">
        <div class="h-50" style="position: relative">
            <Doughnut
                style="height: 200px"
                :chartData="severityDistChartData.data"
                :chartOptions="severityDistChartData.options">
            </Doughnut>
        </div>
        <div class="h-50" style="position: relative">
            <Doughnut
                style="height: 200px"
                :chartData="targetDistChartData.data"
                :chartOptions="targetDistChartData.options">
            </Doughnut>
        </div>
    </div>
</template>